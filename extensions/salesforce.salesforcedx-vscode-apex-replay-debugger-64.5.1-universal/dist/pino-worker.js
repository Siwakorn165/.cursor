"use strict";var Hn=Object.defineProperty;var s=(e,t)=>Hn(e,"name",{value:t,configurable:!0});var O=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var xe=O((au,vt)=>{"use strict";var Z=s(e=>e&&typeof e.message=="string","isErrorLike"),Oe=s(e=>{if(!e)return;let t=e.cause;if(typeof t=="function"){let r=e.cause();return Z(r)?r:void 0}else return Z(t)?t:void 0},"getErrorCause"),_t=s((e,t)=>{if(!Z(e))return"";let r=e.stack||"";if(t.has(e))return r+`
causes have become circular...`;let n=Oe(e);return n?(t.add(e),r+`
caused by: `+_t(n,t)):r},"_stackWithCauses"),Xn=s(e=>_t(e,new Set),"stackWithCauses"),Et=s((e,t,r)=>{if(!Z(e))return"";let n=r?"":e.message||"";if(t.has(e))return n+": ...";let i=Oe(e);if(i){t.add(e);let l=typeof e.cause=="function";return n+(l?"":": ")+Et(i,t,l)}else return n},"_messageWithCauses"),Yn=s(e=>Et(e,new Set),"messageWithCauses");vt.exports={isErrorLike:Z,getErrorCause:Oe,stackWithCauses:Xn,messageWithCauses:Yn}});var Le=O((du,xt)=>{"use strict";var Qn=Symbol("circular-ref-tag"),ie=Symbol("pino-raw-err-ref"),Ot=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:s(function(){return this[ie]},"get"),set:s(function(e){this[ie]=e},"set")}});Object.defineProperty(Ot,ie,{writable:!0,value:{}});xt.exports={pinoErrProto:Ot,pinoErrorSymbols:{seen:Qn,rawSymbol:ie}}});var jt=O((mu,$t)=>{"use strict";$t.exports=je;var{messageWithCauses:Zn,stackWithCauses:ei,isErrorLike:Lt}=xe(),{pinoErrProto:ti,pinoErrorSymbols:ri}=Le(),{seen:$e}=ri,{toString:ni}=Object.prototype;function je(e){if(!Lt(e))return e;e[$e]=void 0;let t=Object.create(ti);t.type=ni.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=Zn(e),t.stack=ei(e),Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>je(r)));for(let r in e)if(t[r]===void 0){let n=e[r];Lt(n)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(n,$e)&&(t[r]=je(n)):t[r]=n}return delete e[$e],t.raw=e,t}s(je,"errSerializer")});var Tt=O((pu,At)=>{"use strict";At.exports=oe;var{isErrorLike:Ae}=xe(),{pinoErrProto:ii,pinoErrorSymbols:si}=Le(),{seen:se}=si,{toString:oi}=Object.prototype;function oe(e){if(!Ae(e))return e;e[se]=void 0;let t=Object.create(ii);t.type=oi.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=e.message,t.stack=e.stack,Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>oe(r))),Ae(e.cause)&&!Object.prototype.hasOwnProperty.call(e.cause,se)&&(t.cause=oe(e.cause));for(let r in e)if(t[r]===void 0){let n=e[r];Ae(n)?Object.prototype.hasOwnProperty.call(n,se)||(t[r]=oe(n)):t[r]=n}return delete e[se],t.raw=e,t}s(oe,"errWithCauseSerializer")});var qt=O((wu,Bt)=>{"use strict";Bt.exports={mapHttpRequest:li,reqSerializer:Rt};var Te=Symbol("pino-raw-req-ref"),kt=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:s(function(){return this[Te]},"get"),set:s(function(e){this[Te]=e},"set")}});Object.defineProperty(kt,Te,{writable:!0,value:{}});function Rt(e){let t=e.info||e.socket,r=Object.create(kt);if(r.id=typeof e.id=="function"?e.id():e.id||(e.info?e.info.id:void 0),r.method=e.method,e.originalUrl)r.url=e.originalUrl;else{let n=e.path;r.url=typeof n=="string"?n:e.url?e.url.path||e.url:void 0}return e.query&&(r.query=e.query),e.params&&(r.params=e.params),r.headers=e.headers,r.remoteAddress=t&&t.remoteAddress,r.remotePort=t&&t.remotePort,r.raw=e.raw||e,r}s(Rt,"reqSerializer");function li(e){return{req:Rt(e)}}s(li,"mapHttpRequest")});var Nt=O((_u,Dt)=>{"use strict";Dt.exports={mapHttpResponse:fi,resSerializer:It};var ke=Symbol("pino-raw-res-ref"),Ct=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:s(function(){return this[ke]},"get"),set:s(function(e){this[ke]=e},"set")}});Object.defineProperty(Ct,ke,{writable:!0,value:{}});function It(e){let t=Object.create(Ct);return t.statusCode=e.headersSent?e.statusCode:null,t.headers=e.getHeaders?e.getHeaders():e._headers,t.raw=e,t}s(It,"resSerializer");function fi(e){return{res:It(e)}}s(fi,"mapHttpResponse")});var Be=O((vu,Pt)=>{"use strict";var Re=jt(),ui=Tt(),le=qt(),fe=Nt();Pt.exports={err:Re,errWithCause:ui,mapHttpRequest:le.mapHttpRequest,mapHttpResponse:fe.mapHttpResponse,req:le.reqSerializer,res:fe.resSerializer,wrapErrorSerializer:s(function(t){return t===Re?t:s(function(n){return t(Re(n))},"wrapErrSerializer")},"wrapErrorSerializer"),wrapRequestSerializer:s(function(t){return t===le.reqSerializer?t:s(function(n){return t(le.reqSerializer(n))},"wrappedReqSerializer")},"wrapRequestSerializer"),wrapResponseSerializer:s(function(t){return t===fe.resSerializer?t:s(function(n){return t(fe.resSerializer(n))},"wrappedResSerializer")},"wrapResponseSerializer")}});var qe=O((xu,Mt)=>{"use strict";function ci(e,t){return t}s(ci,"noOpPrepareStackTrace");Mt.exports=s(function(){let t=Error.prepareStackTrace;Error.prepareStackTrace=ci;let r=new Error().stack;if(Error.prepareStackTrace=t,!Array.isArray(r))return;let n=r.slice(2),i=[];for(let l of n)l&&i.push(l.getFileName());return i},"getCallers")});var zt=O(($u,Wt)=>{"use strict";Wt.exports=ai;function ai(e={}){let{ERR_PATHS_MUST_BE_STRINGS:t=s(()=>"fast-redact - Paths must be (non-empty) strings","ERR_PATHS_MUST_BE_STRINGS"),ERR_INVALID_PATH:r=s(n=>`fast-redact \u2013 Invalid path (${n})`,"ERR_INVALID_PATH")}=e;return s(function({paths:i}){i.forEach(l=>{if(typeof l!="string")throw Error(t());try{if(/ã€‡/.test(l))throw Error();let h=(l[0]==="["?"":".")+l.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(h)||/\/\*/.test(h))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${h}
            if ([o${h}].length !== 1) throw Error()`)()}catch{throw Error(r(l))}})},"validate")}s(ai,"validator")});var ue=O((Au,Ft)=>{"use strict";Ft.exports=/[^.[\]]+|\[((?:.)*?)\]/g});var Vt=O((Tu,Kt)=>{"use strict";var hi=ue();Kt.exports=di;function di({paths:e}){let t=[];var r=0;let n=e.reduce(function(i,l,h){var u=l.match(hi).map(c=>c.replace(/'|"|`/g,""));let a=l[0]==="[";u=u.map(c=>c[0]==="["?c.substr(1,c.length-2):c);let d=u.indexOf("*");if(d>-1){let c=u.slice(0,d),f=c.join("."),b=u.slice(d+1,u.length),y=b.length>0;r++,t.push({before:c,beforeStr:f,after:b,nested:y})}else i[l]={path:u,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(l),leadingBracket:a};return i},{});return{wildcards:t,wcLen:r,secret:n}}s(di,"parse")});var Jt=O((Ru,Ut)=>{"use strict";var yi=ue();Ut.exports=mi;function mi({secret:e,serialize:t,wcLen:r,strict:n,isCensorFct:i,censorFctTakesPath:l},h){let u=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${wi(n,t)}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${gi(e,i,l)}
    this.compileRestore()
    ${pi(r>0,i,l)}
    this.secret = originalSecret
    ${bi(t)}
  `).bind(h);return u.state=h,t===!1&&(u.restore=a=>h.restore(a)),u}s(mi,"redactor");function gi(e,t,r){return Object.keys(e).map(n=>{let{escPath:i,leadingBracket:l,path:h}=e[n],u=l?1:0,a=l?"":".",d=[];for(var c;(c=yi.exec(n))!==null;){let[,o]=c,{index:p,input:g}=c;p>u&&d.push(g.substring(0,p-(o?0:1)))}var f=d.map(o=>`o${a}${o}`).join(" && ");f.length===0?f+=`o${a}${n} != null`:f+=` && o${a}${n} != null`;let b=`
      switch (true) {
        ${d.reverse().map(o=>`
          case o${a}${o} === censor:
            secret[${i}].circle = ${JSON.stringify(o)}
            break
        `).join(`
`)}
      }
    `,y=r?`val, ${JSON.stringify(h)}`:"val";return`
      if (${f}) {
        const val = o${a}${n}
        if (val === censor) {
          secret[${i}].precensored = true
        } else {
          secret[${i}].val = val
          o${a}${n} = ${t?`censor(${y})`:"censor"}
          ${b}
        }
      }
    `}).join(`
`)}s(gi,"redactTmpl");function pi(e,t,r){return e===!0?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${t}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${t}, ${r})
      }
    }
  `:""}s(pi,"dynamicRedactTmpl");function bi(e){return e===!1?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}s(bi,"resultTmpl");function wi(e,t){return e===!0?"throw Error('fast-redact: primitives cannot be redacted')":t===!1?"return o":"return this.serialize(o)"}s(wi,"strictImpl")});var Ie=O((qu,Xt)=>{"use strict";Xt.exports={groupRedact:_i,groupRestore:Si,nestedRedact:vi,nestedRestore:Ei};function Si({keys:e,values:t,target:r}){if(r==null||typeof r=="string")return;let n=e.length;for(var i=0;i<n;i++){let l=e[i];r[l]=t[i]}}s(Si,"groupRestore");function _i(e,t,r,n,i){let l=Gt(e,t);if(l==null||typeof l=="string")return{keys:null,values:null,target:l,flat:!0};let h=Object.keys(l),u=h.length,a=t.length,d=i?[...t]:void 0,c=new Array(u);for(var f=0;f<u;f++){let b=h[f];c[f]=l[b],i?(d[a]=b,l[b]=r(l[b],d)):n?l[b]=r(l[b]):l[b]=r}return{keys:h,values:c,target:l,flat:!0}}s(_i,"groupRedact");function Ei(e){for(let t=0;t<e.length;t++){let{target:r,path:n,value:i}=e[t],l=r;for(let h=n.length-1;h>0;h--)l=l[n[h]];l[n[0]]=i}}s(Ei,"nestedRestore");function vi(e,t,r,n,i,l,h){let u=Gt(t,r);if(u==null)return;let a=Object.keys(u),d=a.length;for(var c=0;c<d;c++){let f=a[c];Oi(e,u,f,r,n,i,l,h)}return e}s(vi,"nestedRedact");function Ce(e,t){return e!=null?"hasOwn"in Object?Object.hasOwn(e,t):Object.prototype.hasOwnProperty.call(e,t):!1}s(Ce,"has");function Oi(e,t,r,n,i,l,h,u){let a=i.length,d=a-1,c=r;var f=-1,b,y,o,p=null,g=null,_,w,S=!1,E=0,x=0,L=xi();if(o=b=t[r],typeof b=="object"){for(;b!=null&&++f<a&&(x+=1,r=i[f],p=o,!(r!=="*"&&!g&&!(typeof b=="object"&&r in b)));)if(!(r==="*"&&(g==="*"&&(S=!0),g=r,f!==d))){if(g){let j=Object.keys(b);for(var $=0;$<j.length;$++){let v=j[$];if(w=b[v],_=r==="*",S)L=z(L,v,x),E=f,o=Ht(w,E-1,r,n,i,l,h,u,c,b,y,o,_,v,f,d,L,e,t[c],x+1);else if(_||typeof w=="object"&&w!==null&&r in w){if(_?o=w:o=w[r],y=f!==d?o:h?u?l(o,[...n,c,...i]):l(o):l,_){let A=ee(z(L,v,x),o,t[c]);e.push(A),b[v]=y}else if(w[r]!==y)if(y===void 0&&l!==void 0||Ce(w,r)&&y===o)L=z(L,v,x);else{L=z(L,v,x);let A=ee(z(L,r,x+1),o,t[c]);e.push(A),w[r]=y}}}g=null}else{if(o=b[r],L=z(L,r,x),y=f!==d?o:h?u?l(o,[...n,c,...i]):l(o):l,!(Ce(b,r)&&y===o||y===void 0&&l!==void 0)){let j=ee(L,o,t[c]);e.push(j),b[r]=y}b=b[r]}if(typeof b!="object")break}}}s(Oi,"specialSet");function Gt(e,t){for(var r=-1,n=t.length,i=e;i!=null&&++r<n;)i=i[t[r]];return i}s(Gt,"get");function Ht(e,t,r,n,i,l,h,u,a,d,c,f,b,y,o,p,g,_,w,S){if(t===0&&(b||typeof e=="object"&&e!==null&&r in e)){if(b?f=e:f=e[r],c=o!==p?f:h?u?l(f,[...n,a,...i]):l(f):l,b){let E=ee(g,f,w);_.push(E),d[y]=c}else if(e[r]!==c){if(!(c===void 0&&l!==void 0||Ce(e,r)&&c===f)){let E=ee(z(g,r,S+1),f,w);_.push(E),e[r]=c}}}for(let E in e)typeof e[E]=="object"&&(g=z(g,E,S),Ht(e[E],t-1,r,n,i,l,h,u,a,d,c,f,b,y,o,p,g,_,w,S+1))}s(Ht,"iterateNthLevel");function xi(){return{parent:null,key:null,children:[],depth:0}}s(xi,"tree");function z(e,t,r){if(e.depth===r)return z(e.parent,t,r);var n={parent:e,key:t,depth:r,children:[]};return e.children.push(n),n}s(z,"node");function ee(e,t,r){let n=e,i=[];do i.push(n.key),n=n.parent;while(n.parent!=null);return{path:i,value:t,target:r}}s(ee,"restoreInstr")});var Qt=O((Iu,Yt)=>{"use strict";var{groupRestore:Li,nestedRestore:$i}=Ie();Yt.exports=ji;function ji(){return s(function(){if(this.restore){this.restore.state.secret=this.secret;return}let{secret:t,wcLen:r}=this,n=Object.keys(t),i=Ai(t,n),l=r>0,h=l?{secret:t,groupRestore:Li,nestedRestore:$i}:{secret:t};this.restore=Function("o",Ti(i,n,l)).bind(h),this.restore.state=h},"compileRestore")}s(ji,"restorer");function Ai(e,t){return t.map(r=>{let{circle:n,escPath:i,leadingBracket:l}=e[r],u=n?`o.${n} = secret[${i}].val`:`o${l?"":"."}${r} = secret[${i}].val`,a=`secret[${i}].val = undefined`;return`
      if (secret[${i}].val !== undefined) {
        try { ${u} } catch (e) {}
        ${a}
      }
    `}).join("")}s(Ai,"resetTmpl");function Ti(e,t,r){return`
    const secret = this.secret
    ${r===!0?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${t.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:""}
    ${e}
    return o
  `}s(Ti,"restoreTmpl")});var er=O((Nu,Zt)=>{"use strict";Zt.exports=ki;function ki(e){let{secret:t,censor:r,compileRestore:n,serialize:i,groupRedact:l,nestedRedact:h,wildcards:u,wcLen:a}=e,d=[{secret:t,censor:r,compileRestore:n}];return i!==!1&&d.push({serialize:i}),a>0&&d.push({groupRedact:l,nestedRedact:h,wildcards:u,wcLen:a}),Object.assign(...d)}s(ki,"state")});var nr=O((Mu,rr)=>{"use strict";var tr=zt(),Ri=Vt(),Bi=Jt(),qi=Qt(),{groupRedact:Ci,nestedRedact:Ii}=Ie(),Di=er(),Ni=ue(),Pi=tr(),De=s(e=>e,"noop");De.restore=De;var Mi="[REDACTED]";Ne.rx=Ni;Ne.validator=tr;rr.exports=Ne;function Ne(e={}){let t=Array.from(new Set(e.paths||[])),r="serialize"in e&&(e.serialize===!1||typeof e.serialize=="function")?e.serialize:JSON.stringify,n=e.remove;if(n===!0&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let i=n===!0?void 0:"censor"in e?e.censor:Mi,l=typeof i=="function",h=l&&i.length>1;if(t.length===0)return r||De;Pi({paths:t,serialize:r,censor:i});let{wildcards:u,wcLen:a,secret:d}=Ri({paths:t,censor:i}),c=qi(),f="strict"in e?e.strict:!0;return Bi({secret:d,wcLen:a,serialize:r,strict:f,isCensorFct:l,censorFctTakesPath:h},Di({secret:d,censor:i,compileRestore:c,serialize:r,groupRedact:Ci,nestedRedact:Ii,wildcards:u,wcLen:a}))}s(Ne,"fastRedact")});var X=O((zu,ir)=>{"use strict";var Wi=Symbol("pino.setLevel"),zi=Symbol("pino.getLevel"),Fi=Symbol("pino.levelVal"),Ki=Symbol("pino.levelComp"),Vi=Symbol("pino.useLevelLabels"),Ui=Symbol("pino.useOnlyCustomLevels"),Ji=Symbol("pino.mixin"),Gi=Symbol("pino.lsCache"),Hi=Symbol("pino.chindings"),Xi=Symbol("pino.asJson"),Yi=Symbol("pino.write"),Qi=Symbol("pino.redactFmt"),Zi=Symbol("pino.time"),es=Symbol("pino.timeSliceIndex"),ts=Symbol("pino.stream"),rs=Symbol("pino.stringify"),ns=Symbol("pino.stringifySafe"),is=Symbol("pino.stringifiers"),ss=Symbol("pino.end"),os=Symbol("pino.formatOpts"),ls=Symbol("pino.messageKey"),fs=Symbol("pino.errorKey"),us=Symbol("pino.nestedKey"),cs=Symbol("pino.nestedKeyStr"),as=Symbol("pino.mixinMergeStrategy"),hs=Symbol("pino.msgPrefix"),ds=Symbol("pino.wildcardFirst"),ys=Symbol.for("pino.serializers"),ms=Symbol.for("pino.formatters"),gs=Symbol.for("pino.hooks"),ps=Symbol.for("pino.metadata");ir.exports={setLevelSym:Wi,getLevelSym:zi,levelValSym:Fi,levelCompSym:Ki,useLevelLabelsSym:Vi,mixinSym:Ji,lsCacheSym:Gi,chindingsSym:Hi,asJsonSym:Xi,writeSym:Yi,serializersSym:ys,redactFmtSym:Qi,timeSym:Zi,timeSliceIndexSym:es,streamSym:ts,stringifySym:rs,stringifySafeSym:ns,stringifiersSym:is,endSym:ss,formatOptsSym:os,messageKeySym:ls,errorKeySym:fs,nestedKeySym:us,wildcardFirstSym:ds,needsMetadataGsym:ps,useOnlyCustomLevelsSym:Ui,formattersSym:ms,hooksSym:gs,nestedKeyStrSym:cs,mixinMergeStrategySym:as,msgPrefixSym:hs}});var We=O((Fu,fr)=>{"use strict";var Me=nr(),{redactFmtSym:bs,wildcardFirstSym:ce}=X(),{rx:Pe,validator:ws}=Me,sr=ws({ERR_PATHS_MUST_BE_STRINGS:s(()=>"pino \u2013 redacted paths must be strings","ERR_PATHS_MUST_BE_STRINGS"),ERR_INVALID_PATH:s(e=>`pino \u2013 redact paths array contains an invalid path (${e})`,"ERR_INVALID_PATH")}),or="[Redacted]",lr=!1;function Ss(e,t){let{paths:r,censor:n}=_s(e),i=r.reduce((u,a)=>{Pe.lastIndex=0;let d=Pe.exec(a),c=Pe.exec(a),f=d[1]!==void 0?d[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):d[0];if(f==="*"&&(f=ce),c===null)return u[f]=null,u;if(u[f]===null)return u;let{index:b}=c,y=`${a.substr(b,a.length-1)}`;return u[f]=u[f]||[],f!==ce&&u[f].length===0&&u[f].push(...u[ce]||[]),f===ce&&Object.keys(u).forEach(function(o){u[o]&&u[o].push(y)}),u[f].push(y),u},{}),l={[bs]:Me({paths:r,censor:n,serialize:t,strict:lr})},h=s((...u)=>t(typeof n=="function"?n(...u):n),"topCensor");return[...Object.keys(i),...Object.getOwnPropertySymbols(i)].reduce((u,a)=>{if(i[a]===null)u[a]=d=>h(d,[a]);else{let d=typeof n=="function"?(c,f)=>n(c,[a,...f]):n;u[a]=Me({paths:i[a],censor:d,serialize:t,strict:lr})}return u},l)}s(Ss,"redaction");function _s(e){if(Array.isArray(e))return e={paths:e,censor:or},sr(e),e;let{paths:t,censor:r=or,remove:n}=e;if(Array.isArray(t)===!1)throw Error("pino \u2013 redact must contain an array of strings");return n===!0&&(r=void 0),sr({paths:t,censor:r}),{paths:t,censor:r}}s(_s,"handle");fr.exports=Ss});var cr=O((Vu,ur)=>{"use strict";var Es=s(()=>"","nullTime"),vs=s(()=>`,"time":${Date.now()}`,"epochTime"),Os=s(()=>`,"time":${Math.round(Date.now()/1e3)}`,"unixTime"),xs=s(()=>`,"time":"${new Date(Date.now()).toISOString()}"`,"isoTime");ur.exports={nullTime:Es,epochTime:vs,unixTime:Os,isoTime:xs}});var hr=O((Ju,ar)=>{"use strict";function Ls(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}s(Ls,"tryStringify");ar.exports=$s;function $s(e,t,r){var n=r&&r.stringify||Ls,i=1;if(typeof e=="object"&&e!==null){var l=t.length+i;if(l===1)return e;var h=new Array(l);h[0]=n(e);for(var u=1;u<l;u++)h[u]=n(t[u]);return h.join(" ")}if(typeof e!="string")return e;var a=t.length;if(a===0)return e;for(var d="",c=1-i,f=-1,b=e&&e.length||0,y=0;y<b;){if(e.charCodeAt(y)===37&&y+1<b){switch(f=f>-1?f:0,e.charCodeAt(y+1)){case 100:case 102:if(c>=a||t[c]==null)break;f<y&&(d+=e.slice(f,y)),d+=Number(t[c]),f=y+2,y++;break;case 105:if(c>=a||t[c]==null)break;f<y&&(d+=e.slice(f,y)),d+=Math.floor(Number(t[c])),f=y+2,y++;break;case 79:case 111:case 106:if(c>=a||t[c]===void 0)break;f<y&&(d+=e.slice(f,y));var o=typeof t[c];if(o==="string"){d+="'"+t[c]+"'",f=y+2,y++;break}if(o==="function"){d+=t[c].name||"<anonymous>",f=y+2,y++;break}d+=n(t[c]),f=y+2,y++;break;case 115:if(c>=a)break;f<y&&(d+=e.slice(f,y)),d+=String(t[c]),f=y+2,y++;break;case 37:f<y&&(d+=e.slice(f,y)),d+="%",f=y+2,y++,c--;break}++c}++y}return f===-1?e:(f<b&&(d+=e.slice(f)),d)}s($s,"format")});var Fe=O((Hu,ze)=>{"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let t=function(r){if((r>0&&r<1/0)===!1)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(e,0,0,Number(r))};s(t,"sleep");let e=new Int32Array(new SharedArrayBuffer(4));ze.exports=t}else{let e=function(t){if((t>0&&t<1/0)===!1)throw typeof t!="number"&&typeof t!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let n=Date.now()+Number(t);for(;n>Date.now(););};s(e,"sleep"),ze.exports=e}});var Sr=O((Yu,wr)=>{"use strict";var T=require("fs"),js=require("events"),As=require("util").inherits,dr=require("path"),Ve=Fe(),Ts=require("assert"),ae=100,he=Buffer.allocUnsafe(0),ks=16*1024,yr="buffer",mr="utf8",[Rs,Bs]=(process.versions.node||"0.0").split(".").map(Number),qs=Rs>=22&&Bs>=7;function gr(e,t){t._opening=!0,t._writing=!0,t._asyncDrainScheduled=!1;function r(l,h){if(l){t._reopening=!1,t._writing=!1,t._opening=!1,t.sync?process.nextTick(()=>{t.listenerCount("error")>0&&t.emit("error",l)}):t.emit("error",l);return}let u=t._reopening;t.fd=h,t.file=e,t._reopening=!1,t._opening=!1,t._writing=!1,t.sync?process.nextTick(()=>t.emit("ready")):t.emit("ready"),!t.destroyed&&(!t._writing&&t._len>t.minLength||t._flushPending?t._actualWrite():u&&process.nextTick(()=>t.emit("drain")))}s(r,"fileOpened");let n=t.append?"a":"w",i=t.mode;if(t.sync)try{t.mkdir&&T.mkdirSync(dr.dirname(e),{recursive:!0});let l=T.openSync(e,n,i);r(null,l)}catch(l){throw r(l),l}else t.mkdir?T.mkdir(dr.dirname(e),{recursive:!0},l=>{if(l)return r(l);T.open(e,n,i,r)}):T.open(e,n,i,r)}s(gr,"openFile");function D(e){if(!(this instanceof D))return new D(e);let{fd:t,dest:r,minLength:n,maxLength:i,maxWrite:l,periodicFlush:h,sync:u,append:a=!0,mkdir:d,retryEAGAIN:c,fsync:f,contentMode:b,mode:y}=e||{};t=t||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(n||0,16387),this.file=null,this.destroyed=!1,this.minLength=n||0,this.maxLength=i||0,this.maxWrite=l||ks,this._periodicFlush=h||0,this._periodicFlushTimer=void 0,this.sync=u||!1,this.writable=!0,this._fsync=f||!1,this.append=a||!1,this.mode=y,this.retryEAGAIN=c||(()=>!0),this.mkdir=d||!1;let o,p;if(b===yr)this._writingBuf=he,this.write=Ds,this.flush=Ps,this.flushSync=Ws,this._actualWrite=Fs,o=s(()=>T.writeSync(this.fd,this._writingBuf),"fsWriteSync"),p=s(()=>T.write(this.fd,this._writingBuf,this.release),"fsWrite");else if(b===void 0||b===mr)this._writingBuf="",this.write=Is,this.flush=Ns,this.flushSync=Ms,this._actualWrite=zs,o=s(()=>T.writeSync(this.fd,this._writingBuf,"utf8"),"fsWriteSync"),p=s(()=>T.write(this.fd,this._writingBuf,"utf8",this.release),"fsWrite");else throw new Error(`SonicBoom supports "${mr}" and "${yr}", but passed ${b}`);if(typeof t=="number")this.fd=t,process.nextTick(()=>this.emit("ready"));else if(typeof t=="string")gr(t,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(g,_)=>{if(g){if((g.code==="EAGAIN"||g.code==="EBUSY")&&this.retryEAGAIN(g,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{Ve(ae),this.release(void 0,0)}catch(E){this.release(E)}else setTimeout(p,ae);else this._writing=!1,this.emit("error",g);return}this.emit("write",_);let w=Ke(this._writingBuf,this._len,_);if(this._len=w.len,this._writingBuf=w.writingBuf,this._writingBuf.length){if(!this.sync){p();return}try{do{let E=o(),x=Ke(this._writingBuf,this._len,E);this._len=x.len,this._writingBuf=x.writingBuf}while(this._writingBuf.length)}catch(E){this.release(E);return}}this._fsync&&T.fsyncSync(this.fd);let S=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):S>this.minLength?this._actualWrite():this._ending?S>0?this._actualWrite():(this._writing=!1,de(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(Cs,this)):this.emit("drain"))},this.on("newListener",function(g){g==="drain"&&(this._asyncDrainScheduled=!1)}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}s(D,"SonicBoom");function Ke(e,t,r){return typeof e=="string"&&Buffer.byteLength(e)!==r&&(r=Buffer.from(e).subarray(0,r).toString().length),t=Math.max(t-r,0),e=e.slice(r),{writingBuf:e,len:t}}s(Ke,"releaseWritingBuf");function Cs(e){e.listenerCount("drain")>0&&(e._asyncDrainScheduled=!1,e.emit("drain"))}s(Cs,"emitDrain");As(D,js);function pr(e,t){return e.length===0?he:e.length===1?e[0]:Buffer.concat(e,t)}s(pr,"mergeBuf");function Is(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||r[r.length-1].length+e.length>this.maxWrite?r.push(""+e):r[r.length-1]+=e,this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}s(Is,"write");function Ds(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs,n=this._lens;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||n[n.length-1]+e.length>this.maxWrite?(r.push([e]),n.push(e.length)):(r[r.length-1].push(e),n[n.length-1]+=e.length),this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}s(Ds,"writeBuffer");function br(e){this._flushPending=!0;let t=s(()=>{if(this._fsync)this._flushPending=!1,e();else try{T.fsync(this.fd,n=>{this._flushPending=!1,e(n)})}catch(n){e(n)}this.off("error",r)},"onDrain"),r=s(n=>{this._flushPending=!1,e(n),this.off("drain",t)},"onError");this.once("drain",t),this.once("error",r)}s(br,"callFlushCallbackOnDrain");function Ns(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&br.call(this,e),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}s(Ns,"flush");function Ps(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&br.call(this,e),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}s(Ps,"flushBuffer");D.prototype.reopen=function(e){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(e)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(e&&(this.file=e),this._reopening=!0,this._writing)return;let t=this.fd;this.once("ready",()=>{t!==this.fd&&T.close(t,r=>{if(r)return this.emit("error",r)})}),gr(this.file,this)};D.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():de(this)))};function Ms(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let e="";for(;this._bufs.length||e;){e.length<=0&&(e=this._bufs[0]);try{let t=T.writeSync(this.fd,e,"utf8"),r=Ke(e,this._len,t);e=r.writingBuf,this._len=r.len,e.length<=0&&this._bufs.shift()}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Ve(ae)}}try{T.fsyncSync(this.fd)}catch{}}s(Ms,"flushSync");function Ws(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=he);let e=he;for(;this._bufs.length||e.length;){e.length<=0&&(e=pr(this._bufs[0],this._lens[0]));try{let t=T.writeSync(this.fd,e);e=e.subarray(t),this._len=Math.max(this._len-t,0),e.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Ve(ae)}}}s(Ws,"flushBufferSync");D.prototype.destroy=function(){this.destroyed||de(this)};function zs(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let t=T.writeSync(this.fd,this._writingBuf,"utf8");e(null,t)}catch(t){e(t)}else T.write(this.fd,this._writingBuf,"utf8",e)}s(zs,"actualWrite");function Fs(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:pr(this._bufs.shift(),this._lens.shift()),this.sync)try{let t=T.writeSync(this.fd,this._writingBuf);e(null,t)}catch(t){e(t)}else qs&&(this._writingBuf=Buffer.from(this._writingBuf)),T.write(this.fd,this._writingBuf,e)}s(Fs,"actualWriteBuffer");function de(e){if(e.fd===-1){e.once("ready",de.bind(null,e));return}e._periodicFlushTimer!==void 0&&clearInterval(e._periodicFlushTimer),e.destroyed=!0,e._bufs=[],e._lens=[],Ts(typeof e.fd=="number",`sonic.fd must be a number, got ${typeof e.fd}`);try{T.fsync(e.fd,t)}catch{}function t(){e.fd!==1&&e.fd!==2?T.close(e.fd,r):r()}s(t,"closeWrapped");function r(n){if(n){e.emit("error",n);return}e._ending&&!e._writing&&e.emit("finish"),e.emit("close")}s(r,"done")}s(de,"actualClose");D.SonicBoom=D;D.default=D;wr.exports=D});var Ue=O((Zu,xr)=>{"use strict";var N={exit:[],beforeExit:[]},_r={exit:Us,beforeExit:Js},Y;function Ks(){Y===void 0&&(Y=new FinalizationRegistry(Gs))}s(Ks,"ensureRegistry");function Vs(e){N[e].length>0||process.on(e,_r[e])}s(Vs,"install");function Er(e){N[e].length>0||(process.removeListener(e,_r[e]),N.exit.length===0&&N.beforeExit.length===0&&(Y=void 0))}s(Er,"uninstall");function Us(){vr("exit")}s(Us,"onExit");function Js(){vr("beforeExit")}s(Js,"onBeforeExit");function vr(e){for(let t of N[e]){let r=t.deref(),n=t.fn;r!==void 0&&n(r,e)}N[e]=[]}s(vr,"callRefs");function Gs(e){for(let t of["exit","beforeExit"]){let r=N[t].indexOf(e);N[t].splice(r,r+1),Er(t)}}s(Gs,"clear");function Or(e,t,r){if(t===void 0)throw new Error("the object can't be undefined");Vs(e);let n=new WeakRef(t);n.fn=r,Ks(),Y.register(t,n),N[e].push(n)}s(Or,"_register");function Hs(e,t){Or("exit",e,t)}s(Hs,"register");function Xs(e,t){Or("beforeExit",e,t)}s(Xs,"registerBeforeExit");function Ys(e){if(Y!==void 0){Y.unregister(e);for(let t of["exit","beforeExit"])N[t]=N[t].filter(r=>{let n=r.deref();return n&&n!==e}),Er(t)}}s(Ys,"unregister");xr.exports={register:Hs,registerBeforeExit:Xs,unregister:Ys}});var Lr=O((tc,Qs)=>{Qs.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}});var jr=O((rc,$r)=>{"use strict";function Zs(e,t,r,n,i){let l=Date.now()+n,h=Atomics.load(e,t);if(h===r){i(null,"ok");return}let u=h,a=s(d=>{Date.now()>l?i(null,"timed-out"):setTimeout(()=>{u=h,h=Atomics.load(e,t),h===u?a(d>=1e3?1e3:d*2):h===r?i(null,"ok"):i(null,"not-equal")},d)},"check");a(1)}s(Zs,"wait");function eo(e,t,r,n,i){let l=Date.now()+n,h=Atomics.load(e,t);if(h!==r){i(null,"ok");return}let u=s(a=>{Date.now()>l?i(null,"timed-out"):setTimeout(()=>{h=Atomics.load(e,t),h!==r?i(null,"ok"):u(a>=1e3?1e3:a*2)},a)},"check");u(1)}s(eo,"waitDiff");$r.exports={wait:Zs,waitDiff:eo}});var Tr=O((ic,Ar)=>{"use strict";Ar.exports={WRITE_INDEX:4,READ_INDEX:8}});var Cr=O((sc,qr)=>{"use strict";var{version:to}=Lr(),{EventEmitter:ro}=require("events"),{Worker:no}=require("worker_threads"),{join:io}=require("path"),{pathToFileURL:so}=require("url"),{wait:oo}=jr(),{WRITE_INDEX:B,READ_INDEX:P}=Tr(),lo=require("buffer"),fo=require("assert"),m=Symbol("kImpl"),uo=lo.constants.MAX_STRING_LENGTH,te=class{static{s(this,"FakeWeakRef")}constructor(t){this._value=t}deref(){return this._value}},me=class{static{s(this,"FakeFinalizationRegistry")}register(){}unregister(){}},co=process.env.NODE_V8_COVERAGE?me:global.FinalizationRegistry||me,ao=process.env.NODE_V8_COVERAGE?te:global.WeakRef||te,kr=new co(e=>{e.exited||e.terminate()});function ho(e,t){let{filename:r,workerData:n}=t,l=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||io(__dirname,"lib","worker.js"),h=new no(l,{...t.workerOpts,trackUnmanagedFds:!1,workerData:{filename:r.indexOf("file://")===0?r:so(r).href,dataBuf:e[m].dataBuf,stateBuf:e[m].stateBuf,workerData:{$context:{threadStreamVersion:to},...n}}});return h.stream=new te(e),h.on("message",yo),h.on("exit",Br),kr.register(e,h),h}s(ho,"createWorker");function Rr(e){fo(!e[m].sync),e[m].needDrain&&(e[m].needDrain=!1,e.emit("drain"))}s(Rr,"drain");function ye(e){let t=Atomics.load(e[m].state,B),r=e[m].data.length-t;if(r>0){if(e[m].buf.length===0){e[m].flushing=!1,e[m].ending?Ye(e):e[m].needDrain&&process.nextTick(Rr,e);return}let n=e[m].buf.slice(0,r),i=Buffer.byteLength(n);i<=r?(e[m].buf=e[m].buf.slice(r),ge(e,n,ye.bind(null,e))):e.flush(()=>{if(!e.destroyed){for(Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,B,0);i>e[m].data.length;)r=r/2,n=e[m].buf.slice(0,r),i=Buffer.byteLength(n);e[m].buf=e[m].buf.slice(r),ge(e,n,ye.bind(null,e))}})}else if(r===0){if(t===0&&e[m].buf.length===0)return;e.flush(()=>{Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,B,0),ye(e)})}else M(e,new Error("overwritten"))}s(ye,"nextFlush");function yo(e){let t=this.stream.deref();if(t===void 0){this.exited=!0,this.terminate();return}switch(e.code){case"READY":this.stream=new ao(t),t.flush(()=>{t[m].ready=!0,t.emit("ready")});break;case"ERROR":M(t,e.err);break;case"EVENT":Array.isArray(e.args)?t.emit(e.name,...e.args):t.emit(e.name,e.args);break;case"WARNING":process.emitWarning(e.err);break;default:M(t,new Error("this should not happen: "+e.code))}}s(yo,"onWorkerMessage");function Br(e){let t=this.stream.deref();t!==void 0&&(kr.unregister(t),t.worker.exited=!0,t.worker.off("exit",Br),M(t,e!==0?new Error("the worker thread exited"):null))}s(Br,"onWorkerExit");var Ge=class extends ro{static{s(this,"ThreadStream")}constructor(t={}){if(super(),t.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[m]={},this[m].stateBuf=new SharedArrayBuffer(128),this[m].state=new Int32Array(this[m].stateBuf),this[m].dataBuf=new SharedArrayBuffer(t.bufferSize||4*1024*1024),this[m].data=Buffer.from(this[m].dataBuf),this[m].sync=t.sync||!1,this[m].ending=!1,this[m].ended=!1,this[m].needDrain=!1,this[m].destroyed=!1,this[m].flushing=!1,this[m].ready=!1,this[m].finished=!1,this[m].errored=null,this[m].closed=!1,this[m].buf="",this.worker=ho(this,t),this.on("message",(r,n)=>{this.worker.postMessage(r,n)})}write(t){if(this[m].destroyed)return He(this,new Error("the worker has exited")),!1;if(this[m].ending)return He(this,new Error("the worker is ending")),!1;if(this[m].flushing&&this[m].buf.length+t.length>=uo)try{Je(this),this[m].flushing=!0}catch(r){return M(this,r),!1}if(this[m].buf+=t,this[m].sync)try{return Je(this),!0}catch(r){return M(this,r),!1}return this[m].flushing||(this[m].flushing=!0,setImmediate(ye,this)),this[m].needDrain=this[m].data.length-this[m].buf.length-Atomics.load(this[m].state,B)<=0,!this[m].needDrain}end(){this[m].destroyed||(this[m].ending=!0,Ye(this))}flush(t){if(this[m].destroyed){typeof t=="function"&&process.nextTick(t,new Error("the worker has exited"));return}let r=Atomics.load(this[m].state,B);oo(this[m].state,P,r,1/0,(n,i)=>{if(n){M(this,n),process.nextTick(t,n);return}if(i==="not-equal"){this.flush(t);return}process.nextTick(t)})}flushSync(){this[m].destroyed||(Je(this),Xe(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[m].ready}get destroyed(){return this[m].destroyed}get closed(){return this[m].closed}get writable(){return!this[m].destroyed&&!this[m].ending}get writableEnded(){return this[m].ending}get writableFinished(){return this[m].finished}get writableNeedDrain(){return this[m].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[m].errored}};function He(e,t){setImmediate(()=>{e.emit("error",t)})}s(He,"error");function M(e,t){e[m].destroyed||(e[m].destroyed=!0,t&&(e[m].errored=t,He(e,t)),e.worker.exited?setImmediate(()=>{e[m].closed=!0,e.emit("close")}):e.worker.terminate().catch(()=>{}).then(()=>{e[m].closed=!0,e.emit("close")}))}s(M,"destroy");function ge(e,t,r){let n=Atomics.load(e[m].state,B),i=Buffer.byteLength(t);return e[m].data.write(t,n),Atomics.store(e[m].state,B,n+i),Atomics.notify(e[m].state,B),r(),!0}s(ge,"write");function Ye(e){if(!(e[m].ended||!e[m].ending||e[m].flushing)){e[m].ended=!0;try{e.flushSync();let t=Atomics.load(e[m].state,P);Atomics.store(e[m].state,B,-1),Atomics.notify(e[m].state,B);let r=0;for(;t!==-1;){if(Atomics.wait(e[m].state,P,t,1e3),t=Atomics.load(e[m].state,P),t===-2){M(e,new Error("end() failed"));return}if(++r===10){M(e,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{e[m].finished=!0,e.emit("finish")})}catch(t){M(e,t)}}}s(Ye,"end");function Je(e){let t=s(()=>{e[m].ending?Ye(e):e[m].needDrain&&process.nextTick(Rr,e)},"cb");for(e[m].flushing=!1;e[m].buf.length!==0;){let r=Atomics.load(e[m].state,B),n=e[m].data.length-r;if(n===0){Xe(e),Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,B,0);continue}else if(n<0)throw new Error("overwritten");let i=e[m].buf.slice(0,n),l=Buffer.byteLength(i);if(l<=n)e[m].buf=e[m].buf.slice(n),ge(e,i,t);else{for(Xe(e),Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,B,0);l>e[m].buf.length;)n=n/2,i=e[m].buf.slice(0,n),l=Buffer.byteLength(i);e[m].buf=e[m].buf.slice(n),ge(e,i,t)}}}s(Je,"writeSync");function Xe(e){if(e[m].flushing)throw new Error("unable to flush while flushing");let t=Atomics.load(e[m].state,B),r=0;for(;;){let n=Atomics.load(e[m].state,P);if(n===-2)throw Error("_flushSync failed");if(n!==t)Atomics.wait(e[m].state,P,n,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}s(Xe,"flushSync");qr.exports=Ge});var et=O((lc,Ir)=>{"use strict";var{createRequire:mo}=require("module"),go=qe(),{join:Qe,isAbsolute:po,sep:bo}=require("node:path"),wo=Fe(),Ze=Ue(),So=Cr();function _o(e){Ze.register(e,vo),Ze.registerBeforeExit(e,Oo),e.on("close",function(){Ze.unregister(e)})}s(_o,"setupOnExit");function Eo(e,t,r,n){let i=new So({filename:e,workerData:t,workerOpts:r,sync:n});i.on("ready",l),i.on("close",function(){process.removeListener("exit",h)}),process.on("exit",h);function l(){process.removeListener("exit",h),i.unref(),r.autoEnd!==!1&&_o(i)}s(l,"onReady");function h(){i.closed||(i.flushSync(),wo(100),i.end())}return s(h,"onExit"),i}s(Eo,"buildStream");function vo(e){e.ref(),e.flushSync(),e.end(),e.once("close",function(){e.unref()})}s(vo,"autoEnd");function Oo(e){e.flushSync()}s(Oo,"flush");function xo(e){let{pipeline:t,targets:r,levels:n,dedupe:i,worker:l={},caller:h=go(),sync:u=!1}=e,a={...e.options},d=typeof h=="string"?[h]:h,c="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},f=e.target;if(f&&r)throw new Error("only one of target or targets can be specified");return r?(f=c["pino-worker"]||Qe(__dirname,"worker.js"),a.targets=r.filter(y=>y.target).map(y=>({...y,target:b(y.target)})),a.pipelines=r.filter(y=>y.pipeline).map(y=>y.pipeline.map(o=>({...o,level:y.level,target:b(o.target)})))):t&&(f=c["pino-worker"]||Qe(__dirname,"worker.js"),a.pipelines=[t.map(y=>({...y,target:b(y.target)}))]),n&&(a.levels=n),i&&(a.dedupe=i),a.pinoWillSendConfig=!0,Eo(b(f),a,l,u);function b(y){if(y=c[y]||y,po(y)||y.indexOf("file://")===0)return y;if(y==="pino/file")return Qe(__dirname,"..","file.js");let o;for(let p of d)try{let g=p==="node:repl"?process.cwd()+bo:p;o=mo(g).resolve(y);break}catch{continue}if(!o)throw new Error(`unable to determine transport target for "${y}"`);return o}s(b,"fixTarget")}s(xo,"transport");Ir.exports=xo});var we=O((uc,Jr)=>{"use strict";var Dr=hr(),{mapHttpRequest:Lo,mapHttpResponse:$o}=Be(),rt=Sr(),Nr=Ue(),{lsCacheSym:jo,chindingsSym:Wr,writeSym:Pr,serializersSym:zr,formatOptsSym:Mr,endSym:Ao,stringifiersSym:Fr,stringifySym:Kr,stringifySafeSym:nt,wildcardFirstSym:Vr,nestedKeySym:To,formattersSym:Ur,messageKeySym:ko,errorKeySym:Ro,nestedKeyStrSym:Bo,msgPrefixSym:pe}=X(),{isMainThread:qo}=require("worker_threads"),Co=et();function Q(){}s(Q,"noop");function Io(e,t){if(!t)return r;return s(function(...i){t.call(this,i,r,e)},"hookWrappedLog");function r(n,...i){if(typeof n=="object"){let l=n;n!==null&&(n.method&&n.headers&&n.socket?n=Lo(n):typeof n.setHeader=="function"&&(n=$o(n)));let h;l===null&&i.length===0?h=[null]:(l=i.shift(),h=i),typeof this[pe]=="string"&&l!==void 0&&l!==null&&(l=this[pe]+l),this[Pr](n,Dr(l,h,this[Mr]),e)}else{let l=n===void 0?i.shift():n;typeof this[pe]=="string"&&l!==void 0&&l!==null&&(l=this[pe]+l),this[Pr](null,Dr(l,i,this[Mr]),e)}}}s(Io,"genLog");function tt(e){let t="",r=0,n=!1,i=255,l=e.length;if(l>100)return JSON.stringify(e);for(var h=0;h<l&&i>=32;h++)i=e.charCodeAt(h),(i===34||i===92)&&(t+=e.slice(r,h)+"\\",r=h,n=!0);return n?t+=e.slice(r):t=e,i<32?JSON.stringify(e):'"'+t+'"'}s(tt,"asString");function Do(e,t,r,n){let i=this[Kr],l=this[nt],h=this[Fr],u=this[Ao],a=this[Wr],d=this[zr],c=this[Ur],f=this[ko],b=this[Ro],y=this[jo][r]+n;y=y+a;let o;c.log&&(e=c.log(e));let p=h[Vr],g="";for(let w in e)if(o=e[w],Object.prototype.hasOwnProperty.call(e,w)&&o!==void 0){d[w]?o=d[w](o):w===b&&d.err&&(o=d.err(o));let S=h[w]||p;switch(typeof o){case"undefined":case"function":continue;case"number":Number.isFinite(o)===!1&&(o=null);case"boolean":S&&(o=S(o));break;case"string":o=(S||tt)(o);break;default:o=(S||i)(o,l)}if(o===void 0)continue;let E=tt(w);g+=","+E+":"+o}let _="";if(t!==void 0){o=d[f]?d[f](t):t;let w=h[f]||p;switch(typeof o){case"function":break;case"number":Number.isFinite(o)===!1&&(o=null);case"boolean":w&&(o=w(o)),_=',"'+f+'":'+o;break;case"string":o=(w||tt)(o),_=',"'+f+'":'+o;break;default:o=(w||i)(o,l),_=',"'+f+'":'+o}}return this[To]&&g?y+this[Bo]+g.slice(1)+"}"+_+u:y+g+_+u}s(Do,"asJson");function No(e,t){let r,n=e[Wr],i=e[Kr],l=e[nt],h=e[Fr],u=h[Vr],a=e[zr],d=e[Ur].bindings;t=d(t);for(let c in t)if(r=t[c],(c!=="level"&&c!=="serializers"&&c!=="formatters"&&c!=="customLevels"&&t.hasOwnProperty(c)&&r!==void 0)===!0){if(r=a[c]?a[c](r):r,r=(h[c]||u||i)(r,l),r===void 0)continue;n+=',"'+c+'":'+r}return n}s(No,"asChindings");function Po(e){return e.write!==e.constructor.prototype.write}s(Po,"hasBeenTampered");function be(e){let t=new rt(e);return t.on("error",r),!e.sync&&qo&&(Nr.register(t,Mo),t.on("close",function(){Nr.unregister(t)})),t;function r(n){if(n.code==="EPIPE"){t.write=Q,t.end=Q,t.flushSync=Q,t.destroy=Q;return}t.removeListener("error",r),t.emit("error",n)}s(r,"filterBrokenPipe")}s(be,"buildSafeSonicBoom");function Mo(e,t){e.destroyed||(t==="beforeExit"?(e.flush(),e.on("drain",function(){e.end()})):e.flushSync())}s(Mo,"autoEnd");function Wo(e){return s(function(r,n,i={},l){if(typeof i=="string")l=be({dest:i}),i={};else if(typeof l=="string"){if(i&&i.transport)throw Error("only one of option.transport or stream can be specified");l=be({dest:l})}else if(i instanceof rt||i.writable||i._writableState)l=i,i={};else if(i.transport){if(i.transport instanceof rt||i.transport.writable||i.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(i.transport.targets&&i.transport.targets.length&&i.formatters&&typeof i.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let a;i.customLevels&&(a=i.useOnlyCustomLevels?i.customLevels:Object.assign({},i.levels,i.customLevels)),l=Co({caller:n,...i.transport,levels:a})}if(i=Object.assign({},e,i),i.serializers=Object.assign({},e.serializers,i.serializers),i.formatters=Object.assign({},e.formatters,i.formatters),i.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:h,onChild:u}=i;return h===!1&&(i.level="silent"),u||(i.onChild=Q),l||(Po(process.stdout)?l=process.stdout:l=be({fd:process.stdout.fd||1})),{opts:i,stream:l}},"normalizeArgs")}s(Wo,"createArgsNormalizer");function zo(e,t){try{return JSON.stringify(e)}catch{try{return(t||this[nt])(e)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}s(zo,"stringify");function Fo(e,t,r){return{level:e,bindings:t,log:r}}s(Fo,"buildFormatters");function Ko(e){let t=Number(e);return typeof e=="string"&&Number.isFinite(t)?t:e===void 0?1:e}s(Ko,"normalizeDestFileDescriptor");Jr.exports={noop:Q,buildSafeSonicBoom:be,asChindings:No,asJson:Do,genLog:Io,createArgsNormalizer:Wo,stringify:zo,buildFormatters:Fo,normalizeDestFileDescriptor:Ko}});var Se=O((ac,Gr)=>{var Vo={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},Uo={ASC:"ASC",DESC:"DESC"};Gr.exports={DEFAULT_LEVELS:Vo,SORTING_ORDER:Uo}});var ot=O((hc,Qr)=>{"use strict";var{lsCacheSym:Jo,levelValSym:it,useOnlyCustomLevelsSym:Go,streamSym:Ho,formattersSym:Xo,hooksSym:Yo,levelCompSym:Hr}=X(),{noop:Qo,genLog:U}=we(),{DEFAULT_LEVELS:W,SORTING_ORDER:Xr}=Se(),Yr={fatal:s(e=>{let t=U(W.fatal,e);return function(...r){let n=this[Ho];if(t.call(this,...r),typeof n.flushSync=="function")try{n.flushSync()}catch{}}},"fatal"),error:s(e=>U(W.error,e),"error"),warn:s(e=>U(W.warn,e),"warn"),info:s(e=>U(W.info,e),"info"),debug:s(e=>U(W.debug,e),"debug"),trace:s(e=>U(W.trace,e),"trace")},st=Object.keys(W).reduce((e,t)=>(e[W[t]]=t,e),{}),Zo=Object.keys(st).reduce((e,t)=>(e[t]='{"level":'+Number(t),e),{});function el(e){let t=e[Xo].level,{labels:r}=e.levels,n={};for(let i in r){let l=t(r[i],Number(i));n[i]=JSON.stringify(l).slice(0,-1)}return e[Jo]=n,e}s(el,"genLsCache");function tl(e,t){if(t)return!1;switch(e){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}s(tl,"isStandardLevel");function rl(e){let{labels:t,values:r}=this.levels;if(typeof e=="number"){if(t[e]===void 0)throw Error("unknown level value"+e);e=t[e]}if(r[e]===void 0)throw Error("unknown level "+e);let n=this[it],i=this[it]=r[e],l=this[Go],h=this[Hr],u=this[Yo].logMethod;for(let a in r){if(h(r[a],i)===!1){this[a]=Qo;continue}this[a]=tl(a,l)?Yr[a](u):U(r[a],u)}this.emit("level-change",e,i,t[n],n,this)}s(rl,"setLevel");function nl(e){let{levels:t,levelVal:r}=this;return t&&t.labels?t.labels[r]:""}s(nl,"getLevel");function il(e){let{values:t}=this.levels,r=t[e];return r!==void 0&&this[Hr](r,this[it])}s(il,"isLevelEnabled");function sl(e,t,r){return e===Xr.DESC?t<=r:t>=r}s(sl,"compareLevel");function ol(e){return typeof e=="string"?sl.bind(null,e):e}s(ol,"genLevelComparison");function ll(e=null,t=!1){let r=e?Object.keys(e).reduce((l,h)=>(l[e[h]]=h,l),{}):null,n=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),t?null:st,r),i=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),t?null:W,e);return{labels:n,values:i}}s(ll,"mappings");function fl(e,t,r){if(typeof e=="number"){if(![].concat(Object.keys(t||{}).map(l=>t[l]),r?[]:Object.keys(st).map(l=>+l),1/0).includes(e))throw Error(`default level:${e} must be included in custom levels`);return}let n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:W,t);if(!(e in n))throw Error(`default level:${e} must be included in custom levels`)}s(fl,"assertDefaultLevelFound");function ul(e,t){let{labels:r,values:n}=e;for(let i in t){if(i in n)throw Error("levels cannot be overridden");if(t[i]in r)throw Error("pre-existing level values cannot be used for new levels")}}s(ul,"assertNoLevelCollisions");function cl(e){if(typeof e!="function"&&!(typeof e=="string"&&Object.values(Xr).includes(e)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}s(cl,"assertLevelComparison");Qr.exports={initialLsCache:Zo,genLsCache:el,levelMethods:Yr,getLevel:nl,setLevel:rl,isLevelEnabled:il,mappings:ll,assertNoLevelCollisions:ul,assertDefaultLevelFound:fl,genLevelComparison:ol,assertLevelComparison:cl}});var lt=O((yc,Zr)=>{"use strict";Zr.exports={version:"9.7.0"}});var an=O((gc,cn)=>{"use strict";var{EventEmitter:al}=require("node:events"),{lsCacheSym:hl,levelValSym:dl,setLevelSym:ut,getLevelSym:en,chindingsSym:ct,parsedChindingsSym:yl,mixinSym:ml,asJsonSym:on,writeSym:gl,mixinMergeStrategySym:pl,timeSym:bl,timeSliceIndexSym:wl,streamSym:ln,serializersSym:J,formattersSym:ft,errorKeySym:Sl,messageKeySym:_l,useOnlyCustomLevelsSym:El,needsMetadataGsym:vl,redactFmtSym:Ol,stringifySym:xl,formatOptsSym:Ll,stringifiersSym:$l,msgPrefixSym:tn,hooksSym:jl}=X(),{getLevel:Al,setLevel:Tl,isLevelEnabled:kl,mappings:Rl,initialLsCache:Bl,genLsCache:ql,assertNoLevelCollisions:Cl}=ot(),{asChindings:fn,asJson:Il,buildFormatters:rn,stringify:nn}=we(),{version:Dl}=lt(),Nl=We(),Pl=class{static{s(this,"Pino")}},un={constructor:Pl,child:Ml,bindings:Wl,setBindings:zl,flush:Ul,isLevelEnabled:kl,version:Dl,get level(){return this[en]()},set level(e){this[ut](e)},get levelVal(){return this[dl]},set levelVal(e){throw Error("levelVal is read-only")},[hl]:Bl,[gl]:Kl,[on]:Il,[en]:Al,[ut]:Tl};Object.setPrototypeOf(un,al.prototype);cn.exports=function(){return Object.create(un)};var sn=s(e=>e,"resetChildingsFormatter");function Ml(e,t){if(!e)throw Error("missing bindings for child Pino");t=t||{};let r=this[J],n=this[ft],i=Object.create(this);if(t.hasOwnProperty("serializers")===!0){i[J]=Object.create(null);for(let c in r)i[J][c]=r[c];let a=Object.getOwnPropertySymbols(r);for(var l=0;l<a.length;l++){let c=a[l];i[J][c]=r[c]}for(let c in t.serializers)i[J][c]=t.serializers[c];let d=Object.getOwnPropertySymbols(t.serializers);for(var h=0;h<d.length;h++){let c=d[h];i[J][c]=t.serializers[c]}}else i[J]=r;if(t.hasOwnProperty("formatters")){let{level:a,bindings:d,log:c}=t.formatters;i[ft]=rn(a||n.level,d||sn,c||n.log)}else i[ft]=rn(n.level,sn,n.log);if(t.hasOwnProperty("customLevels")===!0&&(Cl(this.levels,t.customLevels),i.levels=Rl(t.customLevels,i[El]),ql(i)),typeof t.redact=="object"&&t.redact!==null||Array.isArray(t.redact)){i.redact=t.redact;let a=Nl(i.redact,nn),d={stringify:a[Ol]};i[xl]=nn,i[$l]=a,i[Ll]=d}typeof t.msgPrefix=="string"&&(i[tn]=(this[tn]||"")+t.msgPrefix),i[ct]=fn(i,e);let u=t.level||this.level;return i[ut](u),this.onChild(i),i}s(Ml,"child");function Wl(){let t=`{${this[ct].substr(1)}}`,r=JSON.parse(t);return delete r.pid,delete r.hostname,r}s(Wl,"bindings");function zl(e){let t=fn(this,e);this[ct]=t,delete this[yl]}s(zl,"setBindings");function Fl(e,t){return Object.assign(t,e)}s(Fl,"defaultMixinMergeStrategy");function Kl(e,t,r){let n=this[bl](),i=this[ml],l=this[Sl],h=this[_l],u=this[pl]||Fl,a,d=this[jl].streamWrite;e==null?a={}:e instanceof Error?(a={[l]:e},t===void 0&&(t=e.message)):(a=e,t===void 0&&e[h]===void 0&&e[l]&&(t=e[l].message)),i&&(a=u(a,i(a,r,this)));let c=this[on](a,t,r,n),f=this[ln];f[vl]===!0&&(f.lastLevel=r,f.lastObj=a,f.lastMsg=t,f.lastTime=n.slice(this[wl]),f.lastLogger=this),f.write(d?d(c):c)}s(Kl,"write");function Vl(){}s(Vl,"noop");function Ul(e){if(e!=null&&typeof e!="function")throw Error("callback must be a function");let t=this[ln];typeof t.flush=="function"?t.flush(e||Vl):e&&e()}s(Ul,"flush")});var mn=O((yt,yn)=>{"use strict";var{hasOwnProperty:re}=Object.prototype,H=dt();H.configure=dt;H.stringify=H;H.default=H;yt.stringify=H;yt.configure=dt;yn.exports=H;var Jl=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function F(e){return e.length<5e3&&!Jl.test(e)?`"${e}"`:JSON.stringify(e)}s(F,"strEscape");function at(e,t){if(e.length>200||t)return e.sort(t);for(let r=1;r<e.length;r++){let n=e[r],i=r;for(;i!==0&&e[i-1]>n;)e[i]=e[i-1],i--;e[i]=n}return e}s(at,"sort");var Gl=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function ht(e){return Gl.call(e)!==void 0&&e.length!==0}s(ht,"isTypedArrayWithEntries");function hn(e,t,r){e.length<r&&(r=e.length);let n=t===","?"":" ",i=`"0":${n}${e[0]}`;for(let l=1;l<r;l++)i+=`${t}"${l}":${n}${e[l]}`;return i}s(hn,"stringifyTypedArray");function Hl(e){if(re.call(e,"circularValue")){let t=e.circularValue;if(typeof t=="string")return`"${t}"`;if(t==null)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}s(Hl,"getCircularValueOption");function Xl(e){let t;if(re.call(e,"deterministic")&&(t=e.deterministic,typeof t!="boolean"&&typeof t!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return t===void 0?!0:t}s(Xl,"getDeterministicOption");function Yl(e,t){let r;if(re.call(e,t)&&(r=e[t],typeof r!="boolean"))throw new TypeError(`The "${t}" argument must be of type boolean`);return r===void 0?!0:r}s(Yl,"getBooleanOption");function dn(e,t){let r;if(re.call(e,t)){if(r=e[t],typeof r!="number")throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return r===void 0?1/0:r}s(dn,"getPositiveIntegerOption");function G(e){return e===1?"1 item":`${e} items`}s(G,"getItemCount");function Ql(e){let t=new Set;for(let r of e)(typeof r=="string"||typeof r=="number")&&t.add(String(r));return t}s(Ql,"getUniqueReplacerSet");function Zl(e){if(re.call(e,"strict")){let t=e.strict;if(typeof t!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(t)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}s(Zl,"getStrictOption");function dt(e){e={...e};let t=Zl(e);t&&(e.bigint===void 0&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));let r=Hl(e),n=Yl(e,"bigint"),i=Xl(e),l=typeof i=="function"?i:void 0,h=dn(e,"maximumDepth"),u=dn(e,"maximumBreadth");function a(y,o,p,g,_,w){let S=o[y];switch(typeof S=="object"&&S!==null&&typeof S.toJSON=="function"&&(S=S.toJSON(y)),S=g.call(o,y,S),typeof S){case"string":return F(S);case"object":{if(S===null)return"null";if(p.indexOf(S)!==-1)return r;let E="",x=",",L=w;if(Array.isArray(S)){if(S.length===0)return"[]";if(h<p.length+1)return'"[Array]"';p.push(S),_!==""&&(w+=_,E+=`
${w}`,x=`,
${w}`);let k=Math.min(S.length,u),q=0;for(;q<k-1;q++){let V=a(String(q),S,p,g,_,w);E+=V!==void 0?V:"null",E+=x}let C=a(String(q),S,p,g,_,w);if(E+=C!==void 0?C:"null",S.length-1>u){let V=S.length-u-1;E+=`${x}"... ${G(V)} not stringified"`}return _!==""&&(E+=`
${L}`),p.pop(),`[${E}]`}let $=Object.keys(S),j=$.length;if(j===0)return"{}";if(h<p.length+1)return'"[Object]"';let v="",A="";_!==""&&(w+=_,x=`,
${w}`,v=" ");let R=Math.min(j,u);i&&!ht(S)&&($=at($,l)),p.push(S);for(let k=0;k<R;k++){let q=$[k],C=a(q,S,p,g,_,w);C!==void 0&&(E+=`${A}${F(q)}:${v}${C}`,A=x)}if(j>u){let k=j-u;E+=`${A}"...":${v}"${G(k)} not stringified"`,A=x}return _!==""&&A.length>1&&(E=`
${w}${E}
${L}`),p.pop(),`{${E}}`}case"number":return isFinite(S)?String(S):t?t(S):"null";case"boolean":return S===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(S);default:return t?t(S):void 0}}s(a,"stringifyFnReplacer");function d(y,o,p,g,_,w){switch(typeof o=="object"&&o!==null&&typeof o.toJSON=="function"&&(o=o.toJSON(y)),typeof o){case"string":return F(o);case"object":{if(o===null)return"null";if(p.indexOf(o)!==-1)return r;let S=w,E="",x=",";if(Array.isArray(o)){if(o.length===0)return"[]";if(h<p.length+1)return'"[Array]"';p.push(o),_!==""&&(w+=_,E+=`
${w}`,x=`,
${w}`);let j=Math.min(o.length,u),v=0;for(;v<j-1;v++){let R=d(String(v),o[v],p,g,_,w);E+=R!==void 0?R:"null",E+=x}let A=d(String(v),o[v],p,g,_,w);if(E+=A!==void 0?A:"null",o.length-1>u){let R=o.length-u-1;E+=`${x}"... ${G(R)} not stringified"`}return _!==""&&(E+=`
${S}`),p.pop(),`[${E}]`}p.push(o);let L="";_!==""&&(w+=_,x=`,
${w}`,L=" ");let $="";for(let j of g){let v=d(j,o[j],p,g,_,w);v!==void 0&&(E+=`${$}${F(j)}:${L}${v}`,$=x)}return _!==""&&$.length>1&&(E=`
${w}${E}
${S}`),p.pop(),`{${E}}`}case"number":return isFinite(o)?String(o):t?t(o):"null";case"boolean":return o===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(o);default:return t?t(o):void 0}}s(d,"stringifyArrayReplacer");function c(y,o,p,g,_){switch(typeof o){case"string":return F(o);case"object":{if(o===null)return"null";if(typeof o.toJSON=="function"){if(o=o.toJSON(y),typeof o!="object")return c(y,o,p,g,_);if(o===null)return"null"}if(p.indexOf(o)!==-1)return r;let w=_;if(Array.isArray(o)){if(o.length===0)return"[]";if(h<p.length+1)return'"[Array]"';p.push(o),_+=g;let v=`
${_}`,A=`,
${_}`,R=Math.min(o.length,u),k=0;for(;k<R-1;k++){let C=c(String(k),o[k],p,g,_);v+=C!==void 0?C:"null",v+=A}let q=c(String(k),o[k],p,g,_);if(v+=q!==void 0?q:"null",o.length-1>u){let C=o.length-u-1;v+=`${A}"... ${G(C)} not stringified"`}return v+=`
${w}`,p.pop(),`[${v}]`}let S=Object.keys(o),E=S.length;if(E===0)return"{}";if(h<p.length+1)return'"[Object]"';_+=g;let x=`,
${_}`,L="",$="",j=Math.min(E,u);ht(o)&&(L+=hn(o,x,u),S=S.slice(o.length),j-=o.length,$=x),i&&(S=at(S,l)),p.push(o);for(let v=0;v<j;v++){let A=S[v],R=c(A,o[A],p,g,_);R!==void 0&&(L+=`${$}${F(A)}: ${R}`,$=x)}if(E>u){let v=E-u;L+=`${$}"...": "${G(v)} not stringified"`,$=x}return $!==""&&(L=`
${_}${L}
${w}`),p.pop(),`{${L}}`}case"number":return isFinite(o)?String(o):t?t(o):"null";case"boolean":return o===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(o);default:return t?t(o):void 0}}s(c,"stringifyIndent");function f(y,o,p){switch(typeof o){case"string":return F(o);case"object":{if(o===null)return"null";if(typeof o.toJSON=="function"){if(o=o.toJSON(y),typeof o!="object")return f(y,o,p);if(o===null)return"null"}if(p.indexOf(o)!==-1)return r;let g="",_=o.length!==void 0;if(_&&Array.isArray(o)){if(o.length===0)return"[]";if(h<p.length+1)return'"[Array]"';p.push(o);let L=Math.min(o.length,u),$=0;for(;$<L-1;$++){let v=f(String($),o[$],p);g+=v!==void 0?v:"null",g+=","}let j=f(String($),o[$],p);if(g+=j!==void 0?j:"null",o.length-1>u){let v=o.length-u-1;g+=`,"... ${G(v)} not stringified"`}return p.pop(),`[${g}]`}let w=Object.keys(o),S=w.length;if(S===0)return"{}";if(h<p.length+1)return'"[Object]"';let E="",x=Math.min(S,u);_&&ht(o)&&(g+=hn(o,",",u),w=w.slice(o.length),x-=o.length,E=","),i&&(w=at(w,l)),p.push(o);for(let L=0;L<x;L++){let $=w[L],j=f($,o[$],p);j!==void 0&&(g+=`${E}${F($)}:${j}`,E=",")}if(S>u){let L=S-u;g+=`${E}"...":"${G(L)} not stringified"`}return p.pop(),`{${g}}`}case"number":return isFinite(o)?String(o):t?t(o):"null";case"boolean":return o===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(o);default:return t?t(o):void 0}}s(f,"stringifySimple");function b(y,o,p){if(arguments.length>1){let g="";if(typeof p=="number"?g=" ".repeat(Math.min(p,10)):typeof p=="string"&&(g=p.slice(0,10)),o!=null){if(typeof o=="function")return a("",{"":y},[],o,g,"");if(Array.isArray(o))return d("",y,[],Ql(o),g,"")}if(g.length!==0)return c("",y,[],g,"")}return f("",y,[])}return s(b,"stringify"),b}s(dt,"configure")});var bn=O((wc,pn)=>{"use strict";var mt=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:gn}=Se(),ef=gn.info;function tf(e,t){let r=0;e=e||[],t=t||{dedupe:!1};let n=Object.create(gn);n.silent=1/0,t.levels&&typeof t.levels=="object"&&Object.keys(t.levels).forEach(f=>{n[f]=t.levels[f]});let i={write:l,add:a,emit:h,flushSync:u,end:d,minLevel:0,streams:[],clone:c,[mt]:!0,streamLevels:n};return Array.isArray(e)?e.forEach(a,i):a.call(i,e),e=null,i;function l(f){let b,y=this.lastLevel,{streams:o}=this,p=0,g;for(let _=nf(o.length,t.dedupe);of(_,o.length,t.dedupe);_=sf(_,t.dedupe))if(b=o[_],b.level<=y){if(p!==0&&p!==b.level)break;if(g=b.stream,g[mt]){let{lastTime:w,lastMsg:S,lastObj:E,lastLogger:x}=this;g.lastLevel=y,g.lastTime=w,g.lastMsg=S,g.lastObj=E,g.lastLogger=x}g.write(f),t.dedupe&&(p=b.level)}else if(!t.dedupe)break}s(l,"write");function h(...f){for(let{stream:b}of this.streams)typeof b.emit=="function"&&b.emit(...f)}s(h,"emit");function u(){for(let{stream:f}of this.streams)typeof f.flushSync=="function"&&f.flushSync()}s(u,"flushSync");function a(f){if(!f)return i;let b=typeof f.write=="function"||f.stream,y=f.write?f:f.stream;if(!b)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:o,streamLevels:p}=this,g;typeof f.levelVal=="number"?g=f.levelVal:typeof f.level=="string"?g=p[f.level]:typeof f.level=="number"?g=f.level:g=ef;let _={stream:y,level:g,levelVal:void 0,id:r++};return o.unshift(_),o.sort(rf),this.minLevel=o[0].level,i}s(a,"add");function d(){for(let{stream:f}of this.streams)typeof f.flushSync=="function"&&f.flushSync(),f.end()}s(d,"end");function c(f){let b=new Array(this.streams.length);for(let y=0;y<b.length;y++)b[y]={level:f,stream:this.streams[y].stream};return{write:l,add:a,minLevel:f,streams:b,clone:c,emit:h,flushSync:u,[mt]:!0}}s(c,"clone")}s(tf,"multistream");function rf(e,t){return e.level-t.level}s(rf,"compareByLevel");function nf(e,t){return t?e-1:0}s(nf,"initLoopVar");function sf(e,t){return t?e-1:e+1}s(sf,"adjustLoopVar");function of(e,t,r){return r?e>=0:e<t}s(of,"checkLoopVar");pn.exports=tf});var Rn=O((_c,I)=>{function _e(e){try{return require("path").join(`${process.cwd()}${require("path").sep}dist`.replace(/\\/g,"/"),e)}catch{return new Function("p","return new URL(p, import.meta.url).pathname")(e)}}s(_e,"pinoBundlerAbsolutePath");globalThis.__bundlerPathsOverrides={...globalThis.__bundlerPathsOverrides||{},"thread-stream-worker":_e("./thread-stream-worker.js"),"pino-worker":_e("./pino-worker.js"),"pino/file":_e("./pino-file.js"),"pino-pretty":_e("./pino-pretty.js")};var lf=require("node:os"),Ln=Be(),ff=qe(),uf=We(),$n=cr(),cf=an(),jn=X(),{configure:af}=mn(),{assertDefaultLevelFound:hf,mappings:An,genLsCache:df,genLevelComparison:yf,assertLevelComparison:mf}=ot(),{DEFAULT_LEVELS:Tn,SORTING_ORDER:gf}=Se(),{createArgsNormalizer:pf,asChindings:bf,buildSafeSonicBoom:wn,buildFormatters:wf,stringify:gt,normalizeDestFileDescriptor:Sn,noop:Sf}=we(),{version:_f}=lt(),{chindingsSym:_n,redactFmtSym:Ef,serializersSym:En,timeSym:vf,timeSliceIndexSym:Of,streamSym:xf,stringifySym:vn,stringifySafeSym:pt,stringifiersSym:On,setLevelSym:Lf,endSym:$f,formatOptsSym:jf,messageKeySym:Af,errorKeySym:Tf,nestedKeySym:kf,mixinSym:Rf,levelCompSym:Bf,useOnlyCustomLevelsSym:qf,formattersSym:xn,hooksSym:Cf,nestedKeyStrSym:If,mixinMergeStrategySym:Df,msgPrefixSym:Nf}=jn,{epochTime:kn,nullTime:Pf}=$n,{pid:Mf}=process,Wf=lf.hostname(),zf=Ln.err,Ff={level:"info",levelComparison:gf.ASC,levels:Tn,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:Mf,hostname:Wf},serializers:Object.assign(Object.create(null),{err:zf}),formatters:Object.assign(Object.create(null),{bindings(e){return e},level(e,t){return{level:t}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:kn,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},Kf=pf(Ff),Vf=Object.assign(Object.create(null),Ln);function bt(...e){let t={},{opts:r,stream:n}=Kf(t,ff(),...e);r.level&&typeof r.level=="string"&&Tn[r.level.toLowerCase()]!==void 0&&(r.level=r.level.toLowerCase());let{redact:i,crlf:l,serializers:h,timestamp:u,messageKey:a,errorKey:d,nestedKey:c,base:f,name:b,level:y,customLevels:o,levelComparison:p,mixin:g,mixinMergeStrategy:_,useOnlyCustomLevels:w,formatters:S,hooks:E,depthLimit:x,edgeLimit:L,onChild:$,msgPrefix:j}=r,v=af({maximumDepth:x,maximumBreadth:L}),A=wf(S.level,S.bindings,S.log),R=gt.bind({[pt]:v}),k=i?uf(i,R):{},q=i?{stringify:k[Ef]}:{stringify:R},C="}"+(l?`\r
`:`
`),V=bf.bind(null,{[_n]:"",[En]:h,[On]:k,[vn]:gt,[pt]:v,[xn]:A}),ve="";f!==null&&(b===void 0?ve=V(f):ve=V(Object.assign({},f,{name:b})));let wt=u instanceof Function?u:u?kn:Pf,Jn=wt().indexOf(":")+1;if(w&&!o)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(g&&typeof g!="function")throw Error(`Unknown mixin type "${typeof g}" - expected "function"`);if(j&&typeof j!="string")throw Error(`Unknown msgPrefix type "${typeof j}" - expected "string"`);hf(y,o,w);let St=An(o,w);typeof n.emit=="function"&&n.emit("message",{code:"PINO_CONFIG",config:{levels:St,messageKey:a,errorKey:d}}),mf(p);let Gn=yf(p);return Object.assign(t,{levels:St,[Bf]:Gn,[qf]:w,[xf]:n,[vf]:wt,[Of]:Jn,[vn]:gt,[pt]:v,[On]:k,[$f]:C,[jf]:q,[Af]:a,[Tf]:d,[kf]:c,[If]:c?`,${JSON.stringify(c)}:{`:"",[En]:h,[Rf]:g,[Df]:_,[_n]:ve,[xn]:A,[Cf]:E,silent:Sf,onChild:$,[Nf]:j}),Object.setPrototypeOf(t,cf()),df(t),t[Lf](y),t}s(bt,"pino");I.exports=bt;I.exports.destination=(e=process.stdout.fd)=>typeof e=="object"?(e.dest=Sn(e.dest||process.stdout.fd),wn(e)):wn({dest:Sn(e),minLength:0});I.exports.transport=et();I.exports.multistream=bn();I.exports.levels=An();I.exports.stdSerializers=Vf;I.exports.stdTimeFunctions=Object.assign({},$n);I.exports.symbols=jn;I.exports.version=_f;I.exports.default=bt;I.exports.pino=bt});var In=O((vc,Cn)=>{"use strict";var{Transform:Uf}=require("stream"),{StringDecoder:Jf}=require("string_decoder"),K=Symbol("last"),Ee=Symbol("decoder");function Gf(e,t,r){let n;if(this.overflow){if(n=this[Ee].write(e).split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[K]+=this[Ee].write(e),n=this[K].split(this.matcher);this[K]=n.pop();for(let i=0;i<n.length;i++)try{qn(this,this.mapper(n[i]))}catch(l){return r(l)}if(this.overflow=this[K].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}s(Gf,"transform");function Hf(e){if(this[K]+=this[Ee].end(),this[K])try{qn(this,this.mapper(this[K]))}catch(t){return e(t)}e()}s(Hf,"flush");function qn(e,t){t!==void 0&&e.push(t)}s(qn,"push");function Bn(e){return e}s(Bn,"noop");function Xf(e,t,r){switch(e=e||/\r?\n/,t=t||Bn,r=r||{},arguments.length){case 1:typeof e=="function"?(t=e,e=/\r?\n/):typeof e=="object"&&!(e instanceof RegExp)&&!e[Symbol.split]&&(r=e,e=/\r?\n/);break;case 2:typeof e=="function"?(r=t,t=e,e=/\r?\n/):typeof t=="object"&&(r=t,t=Bn)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=Gf,r.flush=Hf,r.readableObjectMode=!0;let n=new Uf(r);return n[K]="",n[Ee]=new Jf("utf8"),n.matcher=e,n.mapper=t,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow||!1,n.overflow=!1,n._destroy=function(i,l){this._writableState.errorEmitted=!1,l(i)},n}s(Xf,"split");Cn.exports=Xf});var Wn=O((xc,Mn)=>{"use strict";var Dn=Symbol.for("pino.metadata"),Yf=In(),{Duplex:Qf}=require("stream"),{parentPort:Nn,workerData:Pn}=require("worker_threads");function Zf(){let e,t,r=new Promise((n,i)=>{e=n,t=i});return r.resolve=e,r.reject=t,r}s(Zf,"createDeferred");Mn.exports=s(function(t,r={}){let n=r.expectPinoConfig===!0&&Pn?.workerData?.pinoWillSendConfig===!0,i=r.parse==="lines",l=typeof r.parseLine=="function"?r.parseLine:JSON.parse,h=r.close||eu,u=Yf(function(d){let c;try{c=l(d)}catch(f){this.emit("unknown",d,f);return}if(c===null){this.emit("unknown",d,"Null value ignored");return}return typeof c!="object"&&(c={data:c,time:Date.now()}),u[Dn]&&(u.lastTime=c.time,u.lastLevel=c.level,u.lastObj=c),i?d:c},{autoDestroy:!0});if(u._destroy=function(d,c){let f=h(d,c);f&&typeof f.then=="function"&&f.then(c,c)},r.expectPinoConfig===!0&&Pn?.workerData?.pinoWillSendConfig!==!0&&setImmediate(()=>{u.emit("error",new Error("This transport is not compatible with the current version of pino. Please upgrade pino to the latest version."))}),r.metadata!==!1&&(u[Dn]=!0,u.lastTime=0,u.lastLevel=0,u.lastObj=null),n){let d={},c=Zf();return Nn.on("message",s(function f(b){b.code==="PINO_CONFIG"&&(d=b.config,c.resolve(),Nn.off("message",f))},"handleMessage")),Object.defineProperties(u,{levels:{get(){return d.levels}},messageKey:{get(){return d.messageKey}},errorKey:{get(){return d.errorKey}}}),c.then(a)}return a();function a(){let d=t(u);if(d&&typeof d.catch=="function")d.catch(c=>{u.destroy(c)}),d=null;else if(r.enablePipelining&&d)return Qf.from({writable:u,readable:d});return u}},"build");function eu(e,t){process.nextTick(t,e)}s(eu,"defaultClose")});var Fn=O(($c,zn)=>{var tu=new Function("modulePath","return import(modulePath)");function ru(e){return typeof __non_webpack__require__=="function"?__non_webpack__require__(e):require(e)}s(ru,"realRequire");zn.exports={realImport:tu,realRequire:ru}});var Vn=O((Ac,Kn)=>{"use strict";var{realImport:nu,realRequire:ne}=Fn();Kn.exports=iu;async function iu(e){let t;try{let r=e.startsWith("file://")?e:"file://"+e;r.endsWith(".ts")||r.endsWith(".cts")?(process[Symbol.for("ts-node.register.instance")]?ne("ts-node/register"):process.env&&process.env.TS_NODE_DEV&&ne("ts-node-dev"),t=ne(decodeURIComponent(e))):t=await nu(r)}catch(r){if(r.code==="ENOTDIR"||r.code==="ERR_MODULE_NOT_FOUND")t=ne(e);else if(r.code===void 0||r.code==="ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING")try{t=ne(decodeURIComponent(e))}catch{throw r}else throw r}if(typeof t=="object"&&(t=t.default),typeof t=="object"&&(t=t.default),typeof t!="function")throw Error("exported worker is not a function");return t}s(iu,"loadTransportStreamBuilder")});var su=require("node:events"),{pipeline:ou,PassThrough:lu}=require("node:stream"),fu=Rn(),uu=Wn(),Un=Vn();module.exports=async function({targets:e,pipelines:t,levels:r,dedupe:n}){let i=[];if(e&&e.length&&(e=await Promise.all(e.map(async u=>{let d=await(await Un(u.target))(u.options);return{level:u.level,stream:d}})),i.push(...e)),t&&t.length&&(t=await Promise.all(t.map(async u=>{let a,d=await Promise.all(u.map(async c=>(a=c.level,await(await Un(c.target))(c.options))));return{level:a,stream:h(d)}})),i.push(...t)),i.length===1)return i[0].stream;return uu(l,{parse:"lines",metadata:!0,close(u,a){let d=0;for(let f of i)d++,f.stream.on("close",c),f.stream.end();function c(){--d===0&&a(u)}s(c,"closeCb")}});function l(u){let a=fu.multistream(i,{levels:r,dedupe:n});u.on("data",function(d){let{lastTime:c,lastMsg:f,lastObj:b,lastLevel:y}=this;a.lastLevel=y,a.lastTime=c,a.lastMsg=f,a.lastObj=b,a.write(d+`
`)})}function h(u){let a=new su,d=new lu({autoDestroy:!0,destroy(c,f){a.on("error",f),a.on("closed",f)}});return ou(d,...u,function(c){if(c&&c.code!=="ERR_STREAM_PREMATURE_CLOSE"){a.emit("error",c);return}a.emit("closed")}),d}};
